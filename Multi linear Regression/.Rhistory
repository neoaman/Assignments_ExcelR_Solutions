model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7508
# model 3 ----
influ_comp <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=100,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp),]
# model 3 ----
influ_comp2 <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=100,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp2),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
# model 3 ----
influ_comp2 <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=50,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp2),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
# model 3 ----
50/nrow(df_comp)
# model 3 ----
500/nrow(df_comp)
influ_comp2 <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=80,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp2),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
influ_comp2 <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=1000,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp2),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
avPlots(model_Comp_4)
pred_C_4 <- predict(model_Comp_4,newdata = df_Comp)
pred_C_4 <- predict(model_Comp_4,newdata = df_comp)
cor(pred_C_4,df_Comp$price) # Correlation is 0.8664749
cor(pred_C_4,df_comp$price) # Correlation is 0.8664749
rmse_C_4 <- mean(model_Comp_4$residuals^2)^.5 # rmse = 281.3819
rmse_C_4
# model 3 ----
1000/nrow(df_comp)
# model 3 ----
200/nrow(df_comp)
influ_comp2 <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=200,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp2),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
avPlots(model_Comp_4)
nrow(df_comp)
# model 3 ----
200/nrow(df_comp)
influ_comp2 <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=200,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp2),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
# model 3 ----
200/nrow(df_comp)
# model 3 ----
50/nrow(df_comp)
influ_comp2 <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=50,col="blue"))))
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influ_comp2),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
avPlots(model_Comp_4)
summary(model_Comp_4) # R2 = 0.7796
influenceIndexPlot(model_Comp_4)
influence_index(model_Comp_4)
influence(model_Comp_4)
influence(model_Comp_4)[]
ii <-influence(model_Comp_4)
ii$wt.res
influenceIndexPlot(model_Comp_4,model = 'Bonferroni')
influenceIndexPlot(model_Comp_4,grid = T)
influence.measures(model_Comp_4)
influence.measures(model_Comp_4)[]
influence.measures(model_Comp_4)$is.inf
sum(influence.measures(model_Comp_4)$is.inf)
colSum(influence.measures(model_Comp_4)$is.inf)
rowSums(influence.measures(model_Comp_4)$is.inf)
rowSums(influence.measures(model_Comp_4)$is.inf) > 0
sum(rowSums(influence.measures(model_Comp_4)$is.inf) > 0)
which(influence.measures(model_Comp_4)$is.inf )
k <- which(influence.measures(model_Comp_4)$is.inf )
k
which(rowSums(influence.measures(model_Comp_4)$is.inf) > 0)
which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0)
length(which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0))
which(rowSums(influence.measures(model_Comp_3)$is.inf) > 0)
length(which(rowSums(influence.measures(model_Comp_3)$is.inf) > 0))
influencing_obs <- which(rowSums(influence.measures(model_Comp_3)$is.inf) > 0)
# model 3 ----
291/nrow(df_comp)
influence(model_Comp_3)
influenceIndexPlot(model_Comp_3)
influencing_obs
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influencing_obs),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
influence(model_Comp_3)
influenceIndexPlot(model_Comp_3)
influencing_obs <- which(rowSums(influence.measures(model_Comp_3)$is.inf) > 0)
291/nrow(df_comp)
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influencing_obs),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
influencing_obs <- which(rowSums(influence.measures(model_Comp_3)$is.inf) > 0);influencing_obs
influencing_obs <- which(rowSums(influence.measures(model_Comp_3)$is.inf) > 0);influencing_obs # These are the influencing observations
influence_obs <- influenceIndexPlot(model_Comp_3)
influence_obs
influence_obs <- influencePlot(model_Comp_3)
influence_obs <- influencePlot(model_Comp_3,id=(n=291))
influence_obs <- influencePlot(model_Comp_3,id=list(n=291))
influence_obs <- influencePlot(model_Comp_3,id=list(n=291,col="red"))
291/nrow(df_comp)
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influence_obs),]
df_Comp_scale <- df_Comp_scale[-c(influence_obs),]
influence_obs
influence_obs <- as.integer(rownames(influencePlot(model_Comp_3,id=list(n=291,col="red"))))
291/nrow(df_comp)
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influence_obs),]
head(df_Comp_scale)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7796
summary(model_Comp_4) # R2 = 0.813
avPlots(model_Comp_4)
pred_C_4 <- predict(model_Comp_4,newdata = df_comp)
cor(pred_C_4,df_comp$price) # Correlation is 0.8664749
cor(pred_C_4,df_comp$price) # Correlation is 0.8790204
rmse_C_4 <- mean(model_Comp_4$residuals^2)^.5 # rmse = 281.3819
rmse_C_4
rmse_C_4 <- mean(model_Comp_4$residuals^2)^.5 # rmse = 232.5537
rmse_C_4
df_comp[influence_index,]
df_comp[influence_obs,]
length(influence_obs)
influence_obs <- as.integer(rownames(influencePlot(model_Comp_3,id=list(n=291,col="red"))))
length(influence_obs)
567/nrow(df_comp)
influence_obs <- as.integer(rownames(influencePlot(model_Comp_3,id=list(n=2,col="red"))))
length(influence_obs)
influence_obs <- as.integer(rownames(influencePlot(model_Comp_3,id=list(n=20,col="red"))))
length(influence_obs)
influence_obs <- as.integer(rownames(influencePlot(model_Comp_3,id=list(n=50,col="red"))))
length(influence_obs)
influence_obs <- as.integer(rownames(influencePlot(model_Comp_3,id=list(n=90,col="red"))))
length(influence_obs)
567/nrow(df_comp)
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influence_obs),]
head(df_Comp_scale)
df_comp[influence_obs,]
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.813
avPlots(model_Comp_4)
pred_C_4 <- predict(model_Comp_4,newdata = df_comp)
cor(pred_C_4,df_comp$price) # Correlation is 0.8790204
summary(model_Comp_4) # R2 = 0.
summary(model_Comp_4) # R2 = 0.7965
avPlots(model_Comp_4)
pred_C_4 <- predict(model_Comp_4,newdata = df_comp)
pred_C_4
cor(pred_C_4,df_comp$price) # Correlation is 0.8799955
rmse_C_4 <- mean(model_Comp_4$residuals^2)^.5 # rmse = 232.5537
rmse_C_4
length(influence_obs)
192/nrow(df_comp)
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influence_obs),]
head(df_Comp_scale)
df_comp[influence_obs,]
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7965
avPlots(model_Comp_4)
pred_C_4 <- predict(model_Comp_4,newdata = df_comp)
cor(pred_C_4,df_comp$price) # Correlation is 0.8799955
rmse_C_4 <- mean(model_Comp_4$residuals^2)^.5 # rmse = 249.1111
#Question No 2 ----
colnames(Comp)
summary(Comp)
write.csv(summary(Comp),'outputs/Comp.csv')
boxplot(Comp[,-c(1,7,8,9)])$out
boxplot(scale(Comp[,-c(1,7,8,9)]))$out
boxplot(scale(log(Comp[,-c(1,7,8,9)])))$out
boxplot(scale(Comp[,-c(1,7,8,9)]))$out
cor(Comp[,-c(1,7:9)])
write.csv(cor(Comp[,-c(1,7:9)]),'outputs/Comp_COR.csv')
#install.packages("rgl")
plot(Comp[,-c(1,7:9)])
#install.packages("rgl")
plot(Comp[,-c(1,7:9)])
plot(Comp[,-c(1,7:9)])
# Model 1  ----
model_Comp_1 <-lm(price~speed+hd+ram+screen+cd+multi+premium+ads+trend,data = df_comp)
summary(model_Comp_1) # R2 = 0.7756
model_Comp_1.1 <- lm(price~.,data=df_comp)
summary(model_Comp_1.1)
192/nrow(df_comp)
length(influence_obs)
192/nrow(df_comp)
cor(pred_C_4,df_comp$price) # Correlation is 0.8799955
vif(model_Comp_1)
pred_C_1 <- predict(model_Comp_1,newdata = df_comp)
cor(pred_C_1,df_comp$price) # Correlation is 0.8806631
rmse_C_1 <- mean(model_Comp_1$residuals^2)^.5 # rmse = 275.1298
influence_1 <- as.integer(rownames(influencePlot(model_Comp_1,id = list(n=10,col="blue",cex=1.2))))
influence_1 <- as.integer(rownames(influencePlot(model_Comp_1,id = list(n=5,col="blue",cex=1.2))))
influenceIndexPlot(model_Comp_1,id=list(n=10,col='red'))
avPlots(model_Comp_3)
influence(model_Comp_3)
influenceIndexPlot(model_Comp_3)
influence(model_Comp)
influence(model_comp)
influence(model_Comp_1)
influenceIndexPlot(model_Comp_1)
influencing_obs <- which(rowSums(influence.measures(model_Comp_3)$is.inf) > 0);influencing_obs # These are the influencing observations
influencing_obs <- which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0);influencing_obs # These are the influencing observations
influence_obs <- as.integer(rownames(influencePlot(model_Comp_1,id=list(n=90,col="red"))))
length(influence_obs)
influencing_obs <- which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0);influencing_obs # These are the influencing observations
influence_obs <- as.integer(rownames(influencePlot(model_Comp_1,id=list(n=90,col="red"))))
influencing_obs
influence_obs
influencing_obs <- which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0);influencing_obs # These are the influencing observations
influencing_obs <- length(which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0);influencing_obs # These are the influencing observations)
influencing_obs <- length(which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0));influencing_obs # These are the influencing observations
influence_obs <- as.integer(rownames(influencePlot(model_Comp_1,id=list(n=90,col="red"))))
length(influence_obs)
length(influence_obs)
192/nrow(df_comp)
df_Comp_scale <- data.frame(df_comp[,-c(6,7,8)],"premium"=df_comp$premium,"cd"=df_comp$cd,"multi"=df_comp$multi)#,"cd"=df_comp3$cd,"multi"=df_comp3$multi
df_Comp_scale <- df_Comp_scale[-c(influence_obs),]
head(df_Comp_scale)
df_comp[influence_obs,]
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.7965
pred_C_4 <- predict(model_Comp_4,newdata = df_comp)
cor(pred_C_4,df_comp$price) # Correlation is 0.8799955
cor(pred_C_4,df_comp$price) # Correlation is 0.879
rmse_C_4 <- mean(model_Comp_4$residuals^2)^.5 # rmse = 249.1111
rmse_C_4
length(unique(influence_obs))
length(influence_obs)
influencing_obs <- length(which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0));influencing_obs # These are the influencing observations
186/nrow(df_comp)
length(influ_comp)
influ_comp <- as.integer(rownames(influencePlot(model_Comp_2,id = list(n=20,col="blue"))))
length(influ_comp)
42/nrow(df_comp)
df_comp3 <- df_comp2[-c(influ_comp),]#head(df_comp2)
model_Comp_3 <- lm(price~.,data=df_comp3)
summary(model_Comp_3) # R2 = 0.7508
cor(pred_C_3,df_comp3$price) # Correlation is 0.8664749
rmse_C_3 <- mean(model_Comp_3$residuals^2)^.5 # rmse = 281.3819
rmse_C_3
influence(model_Comp_1)
influenceIndexPlot(model_Comp_1)
influencing_obs <- length(which(rowSums(influence.measures(model_Comp_1)$is.inf) > 0));influencing_obs # These are the influencing observations
influence_obs <- as.integer(rownames(influencePlot(model_Comp_1,id=list(n=90,col="red"))))
length(influence_obs)
186/nrow(df_comp)
1- 186/nrow(df_comp)
model_Comp_4 <- lm(price~.,data=df_Comp_scale)
summary(model_Comp_4) # R2 = 0.804
cor(pred_C_4,df_comp$price) # Correlation is 0.879
rmse_C_4 <- mean(model_Comp_4$residuals^2)^.5 # rmse = 238.0004
rmse_C_4
cor(pred_C_4,df_comp$price) # Correlation is 0.879
avPlots(model_Comp_4)
Corol <- read.csv("ToyotaCorolla.csv")
str(Corol)
Corolla<-Corol[c("Price","Age_08_04","KM","HP","cc","Doors","Gears","Quarterly_Tax","Weight")]
summary(Corolla)
write.csv(summary(Corolla),"outputs/summary_toyota.csv")
summary(Corolla)
write.csv(summary(Corolla),"outputs/summary_toyota.csv")
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(Corolla)
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(scale(Corolla))
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(scale(Corolla),use.cols = 1:9)
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(scale(Corolla),col = 1:9)
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(log(Corolla),col = 1:9)
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(Corolla,col = 1:9)
boxplot(scale(Corolla),col = 1:9)
boxplot(scale(Corolla),col = 1:9,ylim=c(*10,10))
boxplot(scale(Corolla),col = 1:9,ylim=c(-10,10))
boxplot(scale(Corolla),col = 1:9,ylim=c(-5,5))
boxplot(scale(Corolla),ylim=c(-5,5))
boxplot(Corolla$Weight)
# Checking out the correlations and the Pair plot
cor(Corolla)
write.csv(cor(Corolla),'outputs/cor_coro.csv')
# write.csv(cor(Corolla),'outputs/cor_coro.csv')
# no pair of variables except Age and Price is highly correlated
pairs(Corolla)
model_T_1 <- lm(Price~.,data = Corolla)
model_T_1 <- lm(Price~.,data = Corolla)
summary(model_T_1) # R2 = 0.8638 ........... cc and doors are seems to be insignificant in our model
pred_T_1 <- predict(model_T_1,Corolla)
cor(pred_T_1,Corolla$Price) # We are getting correlation  as 0.9293884
rmse_T_1 <- mean(model_T_1$residuals^2)^.5 # and RMSE value as 1338.258
rmse_T_1
rmse_T_1 <- mean(model_T_1$residuals^2)^.5 ;rmse_T_1# and RMSE value as 1338.258
# Check for the Influence plot
influencePlot(model_T_1)
influence_index <- as.integer(rownames(influencePlot(model_T_1))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
pred_T_2 <- predict(model_T_2,df_Corola)
cor(pred_T_2,df_Corola$Price) # We are getting correlation  as 0.9408428
rmse_T_1 <- mean(model_T_2$residuals^2)^.5 # and RMSE value as 1227.474
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1227.474
# Check for the Influence plot
influencePlot(model_T_1)
influence_index <- as.integer(rownames(influencePlot(model_T_1))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
# Check for the Influence plot
influencePlot(model_T_2)
influence_index <- as.integer(rownames(influencePlot(model_T_2))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
# Check for the Influence plot
influencePlot(model_T_2,id=list(pch=2))
# Check for the Influence plot
influencePlot(model_T_2,id=list(col="forestgreen"))
# Check for the Influence plot
influencePlot(model_T_2,id=list(col="forestgreen"),pch=20)
# Check for the Influence plot
influencePlot(model_T_2,id=list(col="forestgreen"),pch=20,col='lightblue')
influenceIndexPlot(model_T_2)
?influenceIndexPlot
influenceIndexPlot(model_T_2,grid = F)
influenceIndexPlot(model_T_2,grid = T)
influenceIndexPlot(model_T_2,grid = T,col="red")
influenceIndexPlot(model_T_2,grid = T,id = list(col="red"))
influenceIndexPlot(model_T_2,grid = T,id = list(col="red",cex=2))
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=2))
# Check for the Influence plot
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=2))
influenceIndexPlot(model_T_2,grid = T,id = list(col="red",cex=1.5))
avPlot(model_T_1)
avPlot
model_T_1
avPlot(model_T_1)
model_T_1 <- lm(Price~.,data = Corolla)
summary(model_T_1) # R2 = 0.8638 ........... cc and doors are seems to be insignificant in our model
pred_T_1 <- predict(model_T_1,Corolla)
cor(pred_T_1,Corolla$Price) # We are getting correlation  as 0.9293884
rmse_T_1 <- mean(model_T_1$residuals^2)^.5 ;rmse_T_1# and RMSE value as 1338.258
avPlot(model_T_1)
avPlots(model_T_1)
model_T_1 <- lm(Price~.,data = Corolla)
summary(model_T_1) # R2 = 0.8638 ........... cc and doors are seems to be insignificant in our model
rmse_T_1 <- mean(model_T_1$residuals^2)^.5 ;rmse_T_1# and RMSE value as 1338.258
avPlots(model_T_1)
summary(model_T_1) # R2 = 0.8638 ........... cc and doors are seems to be insignificant in our model
influencePlot(model_T_1)
influencePlot(model_T_1,id=list(col="red"))
influencePlot(model_T_1,id=list(col="red"))
# Check for the Influence plot
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=2))
# Check for the Influence plot
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=1.5))
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1227.474
cor(pred_T_2,df_Corola$Price) # We are getting correlation  as 0.9408428
model_T_2 <- lm(Price~.,data = df_Corola)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
pred_T_2 <- predict(model_T_2,df_Corola)
cor(pred_T_2,df_Corola$Price) # We are getting correlation  as 0.9408428
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1227.474
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
pred_T_2 <- predict(model_T_2,df_Corola)
cor(pred_T_2,df_Corola$Price) # We are getting correlation  as 0.9325051
pred_T_2 <- predict(model_T_2,Corolla)
cor(pred_T_2,Corolla$Price) # We are getting correlation  as 0.9325051
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1227.474
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1303.993
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
Corol <- read.csv("ToyotaCorolla.csv")
str(Corol)
Corolla<-Corol[c("Price","Age_08_04","KM","HP","cc","Doors","Gears","Quarterly_Tax","Weight")]
summary(Corolla)
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(Corolla,col = 1:9)
boxplot(scale(Corolla),ylim=c(-5,5))
# Checking out the correlations and the Pair plot
cor(Corolla)
# write.csv(cor(Corolla),'outputs/cor_coro.csv')
# no pair of variables except Age and Price is highly correlated
pairs(Corolla)
#Target Price
#Building my first model
model_T_1 <- lm(Price~.,data = Corolla)
summary(model_T_1) # R2 = 0.8638 ........... cc and doors are seems to be insignificant in our model
pred_T_1 <- predict(model_T_1,Corolla)
cor(pred_T_1,Corolla$Price) # We are getting correlation  as 0.9293884
rmse_T_1 <- mean(model_T_1$residuals^2)^.5 ;rmse_T_1# and RMSE value as 1338.258
avPlots(model_T_1)
# Check for the Influence plot
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=1.5))
influencePlot(model_T_1,id=list(col="red"))
influence_index <- as.integer(rownames(influencePlot(model_T_1))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=2))
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
pred_T_2 <- predict(model_T_2,Corolla)
cor(pred_T_2,Corolla$Price) # We are getting correlation  as 0.9325051
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1303.993
# Check for the Influence plot
influencePlot(model_T_2,id=list(col="forestgreen"),pch=20,col='lightblue')
influence_index <- as.integer(rownames(influencePlot(model_T_2))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
influenceIndexPlot(model_T_2,grid = T,id = list(col="red",cex=1.5))
Corol <- read.csv("ToyotaCorolla.csv")
str(Corol)
Corolla<-Corol[c("Price","Age_08_04","KM","HP","cc","Doors","Gears","Quarterly_Tax","Weight")]
summary(Corolla)
#write.csv(summary(Corolla),"outputs/summary_toyota.csv")
boxplot(Corolla,col = 1:9)
boxplot(scale(Corolla),ylim=c(-5,5))
# Checking out the correlations and the Pair plot
cor(Corolla)
# write.csv(cor(Corolla),'outputs/cor_coro.csv')
# no pair of variables except Age and Price is highly correlated
pairs(Corolla)
#Target Price
#Building my first model
model_T_1 <- lm(Price~.,data = Corolla)
summary(model_T_1) # R2 = 0.8638 ........... cc and doors are seems to be insignificant in our model
pred_T_1 <- predict(model_T_1,Corolla)
cor(pred_T_1,Corolla$Price) # We are getting correlation  as 0.9293884
rmse_T_1 <- mean(model_T_1$residuals^2)^.5 ;rmse_T_1# and RMSE value as 1338.258
avPlots(model_T_1)
# Check for the Influence plot
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=1.5))
influencePlot(model_T_1,id=list(col="red"))
influence_index <- as.integer(rownames(influencePlot(model_T_1))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=2))
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
pred_T_2 <- predict(model_T_2,Corolla)
cor(pred_T_2,Corolla$Price) # We are getting correlation  as 0.9325051
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1303.993
# Check for the Influence plot
influencePlot(model_T_2,id=list(col="forestgreen"),pch=20,col='lightblue')
influence_index <- as.integer(rownames(influencePlot(model_T_2))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
influenceIndexPlot(model_T_2,grid = T,id = list(col="red",cex=1.5))
pred_T_2 <- predict(model_T_2,df_Corola)
cor(pred_T_2,df_Corola$Price) # We are getting correlation  as 0.9325051
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1303.993
influence_index
influence_index <- as.integer(rownames(influencePlot(model_T_1))) # Ok, here we are getting 3 influence index in our model
influence_index
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
influenceIndexPlot(model_T_1,grid = T,id = list(col="red",cex=2))
#Building my Second model
df_Corola <- Corolla[-c(influence_index),]
model_T_2 <- lm(Price~.,data = df_Corola)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
pred_T_2 <- predict(model_T_2,df_Corola)
cor(pred_T_2,df_Corola$Price) # We are getting correlation  as 0.9408425
rmse_T_2 <- mean(model_T_2$residuals^2)^.5;rmse_T_2 # and RMSE value as 1227.474
# Check for the Influence plot
influencePlot(model_T_2,id=list(col="forestgreen"),pch=20,col='lightblue')
influence_index2 <- as.integer(rownames(influencePlot(model_T_2))) # Ok, here we are getting 3 influence index in our model
vif(model_T_1) # ok, in our model we can say there is no colinearity problem exists as all the vif values are less than 10
influenceIndexPlot(model_T_2,grid = T,id = list(col="red",cex=1.5))
avPlots(model_T_2)
summary(model_T_2) # R2 = 0.8852... cc and doors are now significant
cor(pred_T_2,df_Corola$Price) # We are getting correlation  as 0.9408425
avPlots(model_T_2)
